---
import '../styles/pages/404.scss'

import Layout from '../layouts/Layout.astro'

const currentPath = Astro.url.pathname
const lastPath = currentPath?.split('/').pop() || ''
if (lastPath) {
    if (!lastPath.includes('.') && !lastPath.endsWith('/')) return Astro.redirect(`${currentPath}/`)
}
---
<Layout title="404" pTitle="Not Found">
    <section class="error-404">
        <span class="current-URL-not-found">
            <a href=""><span class="page">the requested page</span></a> Cound not be found
        </span>
        <p>Error Type: 404</p>
    </section>
    <script>
        // Helper function to update 404 page content dynamically
        function initialize404Page() {
            const pageElement = document.querySelector('.page')
            const linkElement = pageElement?.parentNode as HTMLAnchorElement
            
            if (pageElement && linkElement) {
                // Set the link to the current pathname
                linkElement.href = location.pathname
                
                // Update page text if not already on 404 page
                if (!location.pathname.startsWith('/404')) {
                    pageElement.textContent = location.pathname
                }
            }
        }
        
        // Initialize 404 page functionality
        if (document.querySelector('.page')) {
            initialize404Page()
        }
    </script>
</Layout>