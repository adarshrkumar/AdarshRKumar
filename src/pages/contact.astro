---
// Imports
import '../styles/pages/[about, contact].scss'

import Layout from '../layouts/Layout.astro'
import Input from '../defaultComponents/Input.astro'
import TextArea from '../defaultComponents/TextArea.astro'
import type { FormConfig, FormField } from '../lib/types'
import type { HTMLAttributes } from 'astro/types'

// Extract input type from HTMLAttributes
type HTMLInputTypeAttribute = HTMLAttributes<'input'>['type']

// Configuration
// Form configuration
const formConfig: FormConfig = {
    action: "https://getform.io/f/qalorpyb",
    method: "POST",
    className: "contact"
}

// Form field configurations
const formFields: Record<string, FormField> = {
    name: {
        type: "text" as const,
        name: "FromName",
        id: "name",
        placeholder: "What's your name?",
        required: "TRUE",
        align: "left",
        label: "Name: "
    },
    email: {
        type: "email" as const,
        name: "From",
        id: "email",
        placeholder: "you@email.tld",
        required: "TRUE",
        align: "left",
        label: "Email: "
    },
    message: {
        type: "textarea" as const,
        label: "Message:",
        name: "TextBody",
        id: "message",
        placeholder: "Type here...",
        required: "TRUE"
    },
    submit: {
        type: "submit" as const,
        name: "submit",
        id: "submit",
        value: "Send",
        className: "contact-button",
        align: "right",
        style: "cursor: pointer; margin-left: auto;"
    }
}

---

<!-- Contact Page -->
<Layout title="Contact">
    <form action={formConfig.action} method={formConfig.method} class={formConfig.className}>
        <Input
            type={formFields.name.type as HTMLInputTypeAttribute} 
            name={formFields.name.name} 
            id={formFields.name.id} 
            placeholder={formFields.name.placeholder} 
            required={formFields.name.required} 
            align={formFields.name.align as "left" | "right" | "center" | undefined}
        >
            {formFields.name.label}
        </Input>
        
        <input hidden type="text" name="FromFull" id="from" />
        
        <Input 
            type={formFields.email.type as HTMLInputTypeAttribute} 
            name={formFields.email.name} 
            id={formFields.email.id} 
            placeholder={formFields.email.placeholder} 
            required={formFields.email.required} 
            align={formFields.email.align as "left" | "right" | "center" | undefined}
        >
            {formFields.email.label}
        </Input>
        
        <TextArea 
            label={formFields.message.label}
            autosize={true}
            rows="1"
            name={formFields.message.name}
            id={formFields.message.id}
            placeholder={formFields.message.placeholder}
            required={formFields.message.required}
        />
        
        <Input 
            type="hidden" 
            name="Subject" 
            id="email-subject" 
            value="Contact Form Submission" 
        />
        
        <Input 
            type={formFields.submit.type as HTMLInputTypeAttribute} 
            value={formFields.submit.value} 
            class={formFields.submit.className} 
            align={formFields.submit.align as "left" | "right" | "center" | undefined} 
            style={formFields.submit.style}
        />
    </form>
</Layout>
<script is:inline>
    // var nEle = document.querySelector('#name')
    // var eEle = document.querySelector('#email')
    // var fEle = document.querySelector('#FromFull')

    // nEle.addEventListener('keypress', updateFrom)
    // eEle.addEventListener('keypress', updateFrom)

    // function updateFrom() {
    //     fEle.value = JSON.stringify({ "Email": eEle.value, "Name": nEle.value, "MailboxHash": null })
    // }
</script>