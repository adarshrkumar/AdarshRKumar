---
// Imports
import '../styles/components/grid.scss'
import '../styles/components/liteGrid.scss'
import type { SiteGridContentProps, GridOptions } from '../lib/types'

// Helper functions
// Helper function to format class items
function formatClassItems(classItems: string | undefined): string {
    return classItems ? ` ${classItems}` : ''
}

// Helper function to generate CSS custom properties from options
function generateCustomProperties(options: GridOptions | undefined): string {
    if (!options || typeof options !== 'object') {
        return ''
    }
    
    let customProperties = ''
    const optionKeys = Object.keys(options)
    
    optionKeys.forEach((key, index) => {
        if (index !== 0) customProperties += ' '
        const value = options[key as keyof GridOptions]
        
        // Handle nested objects (like values: {min: '4rem', max: '495px'})
        if (typeof value === 'object' && value !== null && !Array.isArray(value)) {
            const nestedKeys = Object.keys(value)
            nestedKeys.forEach(nestedKey => {
                customProperties += `--${key}-${nestedKey}: ${(value as Record<string, string>)[nestedKey]}; `
            })
        } else {
            customProperties += `--${key}: ${value};`
        }
    })
    
    return customProperties
}

// Helper function to build CSS class string
function buildCSSClass(mode: string | undefined, classItems: string): string {
    const baseClass = 'grid'
    const liteClass = mode === 'lite' ? ' lite' : ''
    return `${baseClass}${liteClass}${classItems}`
}

// Component props and processing
// Get component props
const { id, classItems, mode, options }: SiteGridContentProps = Astro.props

// Process props
const formattedClassItems = formatClassItems(classItems)
const customProperties = generateCustomProperties(options)
const cssClass = buildCSSClass(mode, formattedClassItems)

---

<!-- Site grid content component -->
<section id={id || ''} class={cssClass} style={customProperties}>
    <slot />
</section>